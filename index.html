<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JAMAL AL-SHUWAIKH - Futuristic Dashboard</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>
    <div class="animated-bg"></div>
    
    <!-- Glowing Header -->
    <header class="glow-header">
        <div class="header-content">
            <div class="shop-branding">
                <h1>JAMAL AL-SHUWAIKH</h1>
                <p class="shop-subtitle">MEN TAILOR & TEXTILE</p>
                <p class="shop-arabic">Ø¬Ù…Ø§Ù„ Ø§Ù„Ø´ÙˆÙŠØ® Ù„Ù„Ø±Ø¬Ø§Ù„ ÙˆÙÙ†Ø³ØªÙ‡Ø§</p>
            </div>
            <div class="shop-contact">
                <p>ğŸ“ 97686004</p>
                <p>ğŸ“ Kuwait â€“ Comm. Area No. 9 â€“ Mariam Comp â€“ Basement â€“ Shop No. 8</p>
            </div>
        </div>
    </header>

    <!-- Three Column Dashboard -->
    <div class="dashboard-container">
        <!-- Column 1: Client Management -->
        <div class="glass-card">
            <h2 class="section-title">
                <span>ğŸ‘¥</span> Add New Client
            </h2>
            
            <form id="clientForm">
                <div class="form-group">
                    <label>Full Name *</label>
                    <input type="text" class="form-input" id="clientName" required placeholder="Enter client name">
                </div>
                
                <div class="form-group">
                    <label>Phone Number *</label>
                    <input type="tel" class="form-input" id="clientPhone" required placeholder="Enter phone number">
                </div>
                
                <div class="form-group">
                    <label>Book Number *</label>
                    <input type="text" class="form-input" id="clientBookNo" required placeholder="Enter book number">
                </div>

                <div class="form-group">
                    <label>Body Measurements (Optional)</label>
                    <div class="measurements-grid">
                        <input type="number" class="measurement-input" placeholder="Chest" step="0.1">
                        <input type="number" class="measurement-input" placeholder="Waist" step="0.1">
                        <input type="number" class="measurement-input" placeholder="Length" step="0.1">
                        <input type="number" class="measurement-input" placeholder="Sleeve" step="0.1">
                        <input type="number" class="measurement-input" placeholder="Shoulder" step="0.1">
                        <input type="number" class="measurement-input" placeholder="Neck" step="0.1">
                        <input type="number" class="measurement-input" placeholder="Hips" step="0.1">
                        <input type="number" class="measurement-input" placeholder="Armhole" step="0.1">
                        <input type="number" class="measurement-input" placeholder="Bicep" step="0.1">
                        <input type="number" class="measurement-input" placeholder="Wrist" step="0.1">
                    </div>
                </div>

                <button type="button" class="btn btn-primary" onclick="saveClient()">
                    <span>ğŸ’¾</span> Save Client
                </button>
            </form>

            <!-- Quick Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <span class="stat-icon">ğŸ‘¥</span>
                    <div class="stat-number" id="totalClients">0</div>
                    <div class="stat-label">Total Clients</div>
                </div>
                <div class="stat-card">
                    <span class="stat-icon">ğŸ“¦</span>
                    <div class="stat-number" id="activeOrders">0</div>
                    <div class="stat-label">Active Orders</div>
                </div>
            </div>
        </div>

        <!-- Column 2: Order Management -->
        <div class="glass-card">
            <h2 class="section-title">
                <span>ğŸ“¦</span> Order Management
            </h2>
            
            <div class="quick-actions">
                <div class="action-btn" onclick="createNewOrder()">
                    <span class="action-icon">â•</span>
                    <div class="action-text">New Order</div>
                </div>
                <div class="action-btn" onclick="showAllOrders()">
                    <span class="action-icon">ğŸ“‹</span>
                    <div class="action-text">View Orders</div>
                </div>
                <div class="action-btn" onclick="showPendingOrders()">
                    <span class="action-icon">â³</span>
                    <div class="action-text">Pending</div>
                </div>
                <div class="action-btn" onclick="showCompletedOrders()">
                    <span class="action-icon">âœ…</span>
                    <div class="action-text">Completed</div>
                </div>
            </div>

            <!-- Order Status Overview -->
            <div class="stats-grid" style="margin-top: 25px;">
                <div class="stat-card">
                    <span class="stat-icon">ğŸ“¥</span>
                    <div class="stat-number" id="receivedOrders">0</div>
                    <div class="stat-label">Received</div>
                </div>
                <div class="stat-card">
                    <span class="stat-icon">âš™ï¸</span>
                    <div class="stat-number" id="processOrders">0</div>
                    <div class="stat-label">In Process</div>
                </div>
                <div class="stat-card">
                    <span class="stat-icon">â³</span>
                    <div class="stat-number" id="pendingOrders">0</div>
                    <div class="stat-label">Pending</div>
                </div>
                <div class="stat-card">
                    <span class="stat-icon">âœ…</span>
                    <div class="stat-number" id="completedOrders">0</div>
                    <div class="stat-label">Completed</div>
                </div>
            </div>

            <!-- Recent Orders -->
            <h3 style="margin: 25px 0 15px 0; color: var(--light); font-size: 1.1rem;">Recent Orders</h3>
            <div class="activity-list" id="recentOrders">
                <div class="activity-item">
                    <span class="activity-icon">ğŸ“¦</span>
                    <div class="activity-content">
                        <div class="activity-title">No orders yet</div>
                        <div class="activity-time">Create your first order</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Column 3: Business Management -->
        <div class="glass-card">
            <h2 class="section-title">
                <span>ğŸ’¼</span> Business Management
            </h2>
            
            <div class="quick-actions">
                <div class="action-btn" onclick="createInvoice()">
                    <span class="action-icon">ğŸ§¾</span>
                    <div class="action-text">Create Invoice</div>
                </div>
                <div class="action-btn" onclick="manageEmployees()">
                    <span class="action-icon">ğŸ‘¨â€ğŸ’¼</span>
                    <div class="action-text">Employees</div>
                </div>
                <div class="action-btn" onclick="manageSalary()">
                    <span class="action-icon">ğŸ’°</span>
                    <div class="action-text">Salary</div>
                </div>
                <div class="action-btn" onclick="manageExpenses()">
                    <span class="action-icon">ğŸ’¸</span>
                    <div class="action-text">Expenses</div>
                </div>
            </div>

            <!-- Financial Overview -->
            <div class="stats-grid" style="margin-top: 25px;">
                <div class="stat-card">
                    <span class="stat-icon">ğŸ’°</span>
                    <div class="stat-number" id="totalRevenue">0</div>
                    <div class="stat-label">Revenue</div>
                </div>
                <div class="stat-card">
                    <span class="stat-icon">ğŸ’¸</span>
                    <div class="stat-number" id="totalExpenses">0</div>
                    <div class="stat-label">Expenses</div>
                </div>
                <div class="stat-card">
                    <span class="stat-icon">ğŸ“Š</span>
                    <div class="stat-number" id="netProfit">0</div>
                    <div class="stat-label">Net Profit</div>
                </div>
                <div class="stat-card">
                    <span class="stat-icon">ğŸ¯</span>
                    <div class="stat-number" id="completionRate">0%</div>
                    <div class="stat-label">Completion</div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div style="margin-top: 25px;">
                <button class="btn btn-success" onclick="generateReport()" style="margin-bottom: 10px;">
                    <span>ğŸ“ˆ</span> Generate Report
                </button>
                <button class="btn btn-warning" onclick="backupData()">
                    <span>ğŸ’¾</span> Backup Data
                </button>
            </div>

            <!-- Recent Activity -->
            <h3 style="margin: 25px 0 15px 0; color: var(--light); font-size: 1.1rem;">Recent Activity</h3>
            <div class="activity-list" id="recentActivity">
                <div class="activity-item">
                    <span class="activity-icon">ğŸ‘‹</span>
                    <div class="activity-content">
                        <div class="activity-title">Welcome to your dashboard!</div>
                        <div class="activity-time">Just now</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="db.js"></script>
    <script src="script.js"></script>
    <script>
        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            loadDashboardData();
            updateStats();
        });

        function loadDashboardData() {
            // Load clients, orders, and update the dashboard
            const clients = getClientsFromDB();
            const orders = getOrdersFromDB();
            const invoices = getInvoicesFromDB();
            const expenses = getExpensesFromDB();
            
            updateStats(clients, orders, invoices, expenses);
            updateRecentOrders(orders);
            updateRecentActivity(clients, orders, invoices);
        }

        function updateStats(clients = [], orders = [], invoices = [], expenses = []) {
            // Update client count
            document.getElementById('totalClients').textContent = clients.length;
            
            // Update order stats
            const activeOrders = orders.filter(order => order.status !== 'completed').length;
            const received = orders.filter(order => order.status === 'received').length;
            const inProcess = orders.filter(order => order.status === 'process').length;
            const pending = orders.filter(order => order.status === 'pending').length;
            const completed = orders.filter(order => order.status === 'completed').length;
            
            document.getElementById('activeOrders').textContent = activeOrders;
            document.getElementById('receivedOrders').textContent = received;
            document.getElementById('processOrders').textContent = inProcess;
            document.getElementById('pendingOrders').textContent = pending;
            document.getElementById('completedOrders').textContent = completed;
            
            // Update financial stats
            const totalRevenue = invoices.reduce((sum, inv) => sum + inv.grandTotal, 0);
            const totalExpenses = expenses.reduce((sum, exp) => sum + exp.amount, 0);
            const netProfit = totalRevenue - totalExpenses;
            const completionRate = orders.length > 0 ? Math.round((completed / orders.length) * 100) : 0;
            
            document.getElementById('totalRevenue').textContent = totalRevenue.toFixed(0);
            document.getElementById('totalExpenses').textContent = totalExpenses.toFixed(0);
            document.getElementById('netProfit').textContent = netProfit.toFixed(0);
            document.getElementById('completionRate').textContent = completionRate + '%';
        }

        function updateRecentOrders(orders = []) {
            const container = document.getElementById('recentOrders');
            const recent = orders.slice(0, 5);
            
            if (recent.length === 0) {
                container.innerHTML = `
                    <div class="activity-item">
                        <span class="activity-icon">ğŸ“¦</span>
                        <div class="activity-content">
                            <div class="activity-title">No orders yet</div>
                            <div class="activity-time">Create your first order</div>
                        </div>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = recent.map(order => `
                <div class="activity-item">
                    <span class="activity-icon">ğŸ“¦</span>
                    <div class="activity-content">
                        <div class="activity-title">${order.clientName} - ${order.orderNumber}</div>
                        <div class="activity-time">${new Date(order.orderDate).toLocaleDateString()} â€¢ KWD ${order.price.toFixed(3)}</div>
                    </div>
                </div>
            `).join('');
        }

        function updateRecentActivity(clients = [], orders = [], invoices = []) {
            const container = document.getElementById('recentActivity');
            const activities = [];
            
            // Add recent clients
            clients.slice(0, 3).forEach(client => {
                activities.push({
                    type: 'client',
                    icon: 'ğŸ‘¥',
                    title: `New client: ${client.name}`,
                    time: new Date(client.createdAt).toLocaleDateString()
                });
            });
            
            // Add recent orders
            orders.slice(0, 3).forEach(order => {
                activities.push({
                    type: 'order',
                    icon: 'ğŸ“¦',
                    title: `New order: ${order.orderNumber}`,
                    time: new Date(order.orderDate).toLocaleDateString()
                });
            });
            
            // Add recent invoices
            invoices.slice(0, 2).forEach(invoice => {
                activities.push({
                    type: 'invoice',
                    icon: 'ğŸ§¾',
                    title: `Invoice created: ${invoice.invoiceNumber}`,
                    time: new Date(invoice.invoiceDate).toLocaleDateString()
                });
            });
            
            // Sort by time and take latest 5
            activities.sort((a, b) => new Date(b.time) - new Date(a.time));
            const recentActivities = activities.slice(0, 5);
            
            if (recentActivities.length === 0) {
                container.innerHTML = `
                    <div class="activity-item">
                        <span class="activity-icon">ğŸ‘‹</span>
                        <div class="activity-content">
                            <div class="activity-title">Welcome to your dashboard!</div>
                            <div class="activity-time">Just now</div>
                        </div>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = recentActivities.map(activity => `
                <div class="activity-item">
                    <span class="activity-icon">${activity.icon}</span>
                    <div class="activity-content">
                        <div class="activity-title">${activity.title}</div>
                        <div class="activity-time">${activity.time}</div>
                    </div>
                </div>
            `).join('');
        }

        // Client Management
        function saveClient() {
            const clientData = {
                id: generateId(),
                name: document.getElementById('clientName').value.trim(),
                phone: document.getElementById('clientPhone').value.trim(),
                bookNo: document.getElementById('clientBookNo').value.trim(),
                measurements: {},
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };

            if (!clientData.name || !clientData.phone || !clientData.bookNo) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }

            const success = saveClientToDB(clientData);
            if (success) {
                document.getElementById('clientForm').reset();
                loadDashboardData();
                showNotification('Client saved successfully!');
            } else {
                showNotification('Error saving client', 'error');
            }
        }

        // Order Management Functions
        function createNewOrder() {
            showNotification('Redirecting to order creation...', 'info');
            // In a full implementation, this would open an order modal
        }

        function showAllOrders() {
            showNotification('Showing all orders...', 'info');
        }

        function showPendingOrders() {
            showNotification('Showing pending orders...', 'info');
        }

        function showCompletedOrders() {
            showNotification('Showing completed orders...', 'info');
        }

        // Business Management Functions
        function createInvoice() {
            showNotification('Opening invoice creator...', 'info');
        }

        function manageEmployees() {
            showNotification('Opening employee management...', 'info');
        }

        function manageSalary() {
            showNotification('Opening salary management...', 'info');
        }

        function manageExpenses() {
            showNotification('Opening expense management...', 'info');
        }

        function generateReport() {
            showNotification('Generating business report...', 'info');
        }

        function backupData() {
            downloadBackup();
        }

        // Utility Functions
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            notification.style.background = type === 'error' ? 'var(--danger)' : 
                                          type === 'success' ? 'var(--accent)' : 'var(--primary)';
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Auto-refresh dashboard every 30 seconds
        setInterval(loadDashboardData, 30000);
    </script>
</body>
</html>
